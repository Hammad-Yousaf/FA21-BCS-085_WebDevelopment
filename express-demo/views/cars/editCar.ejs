<body id="carFormBody">

    <div id="headingContainer">
        <h2 id="carInfoTitle">Edit Car Information</h2>
    </div>
    
    <form id="carForm" action="/cars/<%= car._id %>/edit" method="POST">
      <label for="make">Make:</label>
      <input type="text" id="make" name="make" value="<%= car.make %>" required>
    
      <label for="model">Model:</label>
      <input type="text" id="model" name="model" value="<%= car.model %>" required>
    
      <label for="year">Year:</label>
      <input type="number" id="year" name="year" value="<%= car.year %>" required>
    
      <label for="price">Price:</label>
      <input type="number" id="price" name="price" value="<%= car.price %>" required>
    
      <label for="description">Description:</label>
      <textarea id="description" name="description" rows="4" required><%= car.description %></textarea>
    
      <label for="color">Color:</label>
      <input type="text" id="color" name="color" value="<%= car.color %>" required>
    
      <label for="images">Images:</label>
      <div id="imageContainer">
        <% car.images.forEach((image, index) => { %>
        <div class="imageEntry">
          <label for="images[<%= index %>].url">Image URL:</label>
          <input type="text" id="images[<%= index %>].url" name="images[<%= index %>].url" value="<%= image.url %>" placeholder="Image URL">
        </div>
        <% }); %>
      </div>
      <button type="button" onclick="addImageField()">Add Another Image</button>
    
      <button type="submit" id="uniqueSubmitButton" onclick="showSuccessMessage()">Submit</button>
    
      <!-- Hidden input to hold the number of initial images -->
      <input type="hidden" id="initialImageCount" value="<%= car.images.length %>">
    </form>
    
    <div id="successMessage" style="display:none; color: green;">Success! Your message has been submitted.</div>
    
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            let imageIndex = document.getElementById('initialImageCount').value;
    
            function addImageField() {
                const imageContainer = document.getElementById('imageContainer');
                const newImageEntry = document.createElement('div');
                newImageEntry.className = 'imageEntry';
                newImageEntry.innerHTML = `
                    <label for="images[${imageIndex}].url">Image URL:</label>
                    <input type="text" id="images[${imageIndex}].url" name="images[${imageIndex}].url" placeholder="Image URL">
                `;
                imageContainer.appendChild(newImageEntry);
                imageIndex++;
            }
    
            document.getElementById('carForm').addEventListener('submit', function(event) {
                event.preventDefault(); // Prevent the form from actually submitting
                var successMessage = document.getElementById("successMessage");
                successMessage.style.display = "block";
                setTimeout(function() {
                    successMessage.style.display = "none";
                }, 3000); // Hide the message after 3 seconds
            });
    
            // Make addImageField function globally accessible
            window.addImageField = addImageField;
        });
    </script>
    
    </body>
    